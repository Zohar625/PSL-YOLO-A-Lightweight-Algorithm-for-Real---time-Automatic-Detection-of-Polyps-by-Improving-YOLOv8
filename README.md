# PSL-YOLO: A Lightweight Algorithm for Real - time Automatic Detection of Colonoscopy Polyps by Improving YOLOv8n


## Architecture of our model

![images/Model architecture.png](https://github.com/Zohar625/PSL-YOLO-A-Lightweight-Algorithm-for-Real---time-Automatic-Detection-of-Polyps-by-Improving-YOLOv8/blob/main/images/Model%20Architecture.png?raw=true)



​		This image illustrates the overall architecture of PSL-YOLO. The model adopts PPNHGNetv2 as the backbone to extract feature information. At the same time, Slim-Neck is used as the feature pyramid of the model to perform feature fusion. In the final part, we adopt our designed lightweight detection head to achieve target localization and classification. In the later section, we will provide detailed information about the modules in the model. For the modules whose details are not given later, they are provided by torch.nn, and the specific module details can be viewed on the official website.



## Design of the convolutional part

![images/Conv Moudle.png](https://github.com/Zohar625/PSL-YOLO-A-Lightweight-Algorithm-for-Real---time-Automatic-Detection-of-Polyps-by-Improving-YOLOv8/blob/main/images/Conv%20Moudle.png?raw=true)

​	

​		In many of the module details described later, different types of convolutions will be involved, and their specific configurations are shown above. Among them, *k* represents the kernel size, *s* denotes the stride of the convolution, *p* refers to the additional padding applied to the image, *d* indicates the spacing between kernel elements, and *c* simply represents the number of output channels, which is consistent with the input channels of the previous layer. It is worth mentioning that SiLu is used as the activation function in our DwConv and Conv modules. If necessary, an additional parameter can be designed to store the activation function, allowing users to choose the activation function they need, and the same applies to the batch normalization layer.

​	



## Module details of the backbone

![images/PPHGNet Moudle.png](https://github.com/Zohar625/PSL-YOLO-A-Lightweight-Algorithm-for-Real---time-Automatic-Detection-of-Polyps-by-Improving-YOLOv8/blob/main/images/PPNHGNet%20Moudle.png?raw=true)

​		The details of the backbone modules are shown in the above figure. In addition to the parameters mentioned in the convolution section (k, s, p, d), there is a parameter *cm*. To simplify computation and enhance feature extraction capability, an intermediate channel number is designed in the module, where *cm* represents the number of intermediate channels in the model. Correspondingly, *c1* indicates the number of input channels of the module, while *c2* represents the number of output channels. In the module descriptions above, unless otherwise specified, the module uses default parameters, and the default settings are marked at the lower left corner of the figure. It should be noted that *c* in MaxPool2d refers to the abbreviation of *ceil_mode*, rather than the number of output channels in convolution. *n* denotes the repetition count of intermediate convolution operations. If special instructions are provided, the corresponding parameters should be modified. Specifically, in the HGBlock module, when *act=None* is noted, no activation function is needed for that convolution operation. The information on the arrows indicates the output of the feature map, where *h* represents height and *w* represents width, followed by the channel number of the output. The number of output channels will also serve as the input channel number for the next module. *input* refers to the final output feature map of the previous module, which is also the input of the current module. The *Concat* operation concatenates multiple feature maps along the channel dimension. For example, in HGBlock1, Concat is applied to *input* and the feature maps generated by *n* convolution operations, meaning that the input feature map and the feature maps from *n* convolutions are concatenated along the channel dimension. At this point, *h* and *w* remain unchanged, while the output channel number becomes *c1 + n × cm*.

## Module details of the Feature Pyramid

![images/SlimNeck moudle](https://github.com/Zohar625/PSL-YOLO-A-Lightweight-Algorithm-for-Real---time-Automatic-Detection-of-Polyps-by-Improving-YOLOv8/blob/main/images/SlimNeck%20Moudle.png?raw=true)

​		The details of the feature pyramid are shown in the figure above. In addition to the parameters mentioned in the previous two sections, there are also *bias*, *g*, and *e* that have not been explained. The *bias* parameter indicates whether a bias term is included. A convolution with a *g* parameter represents a grouped convolution, where *g* specifies the number of connections between input and output channels. *e* denotes the expansion ratio of the intermediate channels, which specifically affects the output channel number of the first GSConvns in the GSBottleneckns module. The remaining details are consistent with those in the previous two sections.

# DataSet
This dataset is an endoscopic polyp dataset, in which polyps are classified into two types. In the labels, samples with an ID of 0 correspond to hyperplastic polyps, while samples with an ID of 1 correspond to adenomatous polyps.







